# 報表與分析

## 4.1 財務報表

### 功能描述

查看資產負債表和損益表，了解整體財務狀況。

### 報表類型

#### 1. 資產負債表 (Balance Sheet)

**用途**：顯示某一時點的財務狀況

**內容包含**：

- **資產 (Assets)**
  - 所有資產科目的餘額
  - 資產小計
- **負債 (Liabilities)**
  - 所有負債科目的餘額
  - 負債小計
- **淨資產 (Net Worth / Equity)**
  - 計算公式：資產 - 負債
  - 代表實際擁有的財富

**報表格式**：

```
資產負債表
截止日期：2024/12/31

【資產】
A-現金              10,000
A-銀行存款          50,000
A-投資              30,000
----------------------------
資產總計            90,000

【負債】
L-信用卡            5,000
L-房貸            800,000
----------------------------
負債總計          805,000

【淨資產】
淨資產          -715,000
```

#### 2. 損益表 (Income Statement)

**用途**：顯示某一時期的經營成果

**內容包含**：

- **收入 (Income)**
  - 所有收入科目的金額
  - 收入小計
- **支出 (Expenses)**
  - 所有支出科目的金額
  - 支出小計
- **淨收益 (Net Income)**
  - 計算公式：收入 - 支出
  - 正數表示盈餘，負數表示虧損

**報表格式**：

```
損益表
期間：2024/01/01 - 2024/12/31

【收入】
I-薪資             360,000
I-投資收益          15,000
I-其他收入           5,000
----------------------------
收入總計           380,000

【支出】
E-餐飲費            96,000
E-交通費            36,000
E-娛樂費            48,000
E-購物              72,000
E-房租             180,000
E-其他支出          20,000
----------------------------
支出總計           452,000

【淨收益】
淨收益（虧損）    -72,000
```

### 操作步驟

1. 按下指定選項按鈕
2. 選擇報表日期或日期範圍
   - 資產負債表：選擇截止日期
   - 損益表：選擇起始和結束日期
3. 系統生成報表
4. 可選擇列印或匯出

### 報表功能

- 檢視資產負債表
- 檢視損益表
- 設定報表日期範圍
- 匯出報表為 HTML 或 CSV
- 列印報表

### 業務規則

- 資產負債表反映某一時點的財務狀況
- 損益表反映某一時期的經營成果
- 報表會根據所有交易記錄自動計算
- 修改交易記錄會影響報表結果

---

## 4.2 記錄總覽

### 功能描述

按日期順序列出所有交易記錄，提供完整的交易歷史檢視。

### 操作步驟

1. 點擊相應選項按鈕
2. 設定時間範圍（可選）
   - 不設定：顯示所有記錄
   - 設定日期範圍：顯示特定時期記錄
3. 系統將所有的資料以日期順序列出
4. 可選擇匯出格式

### 顯示內容

**欄位包含**：

- 日期
- 交易類型
- 科目
- 金額
- 明細（最多 125 字元）
- 餘額（累積餘額）

**排序方式**：

- 按日期由舊到新排序
- 同一日期按輸入順序排序

### 匯出功能

#### 匯出為網頁格式（HTML）

- **用途**：便於瀏覽和列印
- **特點**：
  - 格式化顯示
  - 可在瀏覽器開啟
  - 支援列印
  - 無法用於匯入

#### 匯出為 CSV 檔案

- **用途**：資料交換和備份
- **特點**：
  - 完整資料格式
  - 可用 Excel 開啟
  - 可再次匯入軟體
  - 支援進一步分析

### CSV 檔案格式

**欄位順序**：

```
日期,交易類型,支出科目,收入科目,從科目,到科目,金額,明細,發票號碼
2024/01/01,支出,E-餐飲費,,A-現金,,50,午餐,
2024/01/05,收入,,I-薪資,,A-銀行帳戶,30000,月薪,
2024/01/10,轉帳,,,A-現金,A-銀行存款,10000,存錢,
```

### 業務規則

- 記錄總覽包含所有類型的交易
- 最多顯示 125 字元的明細
- 支援時間範圍篩選
- 匯出的 CSV 檔案為完整格式，可供軟體後續匯入使用
- HTML 格式僅供檢視，無法匯入

### 使用場景

- 查看完整交易歷史
- 匯出年度記帳資料
- 備份完整記帳記錄
- 使用 Excel 進行進階分析
- 列印交易清單

---

## 4.3 結帳（清除舊資料）

### 功能描述

清除舊資料以釋放資料庫空間，同時保留科目餘額。

### 資料庫限制

- 一個資料庫有 **30,000 筆**的上限
- 資料太多時可用結帳功能清除舊資料
- 舊資料可另存為新資料庫保留

### 操作步驟

1. 點擊軟體中的結帳功能選項
2. 輸入結帳日期（例如輸入 2005/1/1）
3. 決定是否勾選「結帳後另存新帳本」
   - 勾選：舊資料另存為新資料庫
   - 不勾選：直接刪除舊資料
4. 如有勾選，輸入存放舊資料的資料庫名稱
5. 按確定執行結帳
6. 系統處理並完成結帳操作

### 結帳處理邏輯

#### 刪除交易記錄

- 刪除結帳日期之前的所有交易記錄
- 範例：設定 2024/01/01，則刪除 2024/01/01 之前的記錄

#### 保留科目餘額

- 計算結帳日期時各科目的餘額
- 將餘額作為期初餘額保留
- 確保資產負債表的連續性

#### 舊資料處理

- **另存新帳本**：舊資料完整保存在新資料庫中
- **不另存**：舊資料永久刪除，無法復原

### 結帳結果

**主帳本**：

- 保留結帳日期後的所有交易
- 保留各科目在結帳日的餘額作為期初
- 釋放資料庫空間供新資料使用

**舊資料庫**（如有另存）：

- 包含結帳日期前的所有交易記錄
- 可隨時開啟查看歷史資料
- 獨立的完整帳本

### 使用範例

#### 範例：年度結帳

```
目前帳本：2020-2024 的所有記錄（共 28,000 筆）
結帳日期：2024/01/01
另存新帳本：是
新帳本名稱：2020-2023歷史資料

結果：
主帳本：
- 包含 2024/01/01 之後的記錄
- 保留各科目在 2024/01/01 的餘額
- 記錄數大幅減少

新帳本「2020-2023歷史資料」：
- 包含 2020-2023 的所有記錄
- 可隨時查詢歷史資料
```

### 業務規則

- 結帳前建議先備份
- 結帳是不可逆操作（除非從備份還原）
- 結帳不影響報表的連續性
- 另存的舊帳本可隨時開啟查看
- 建議定期結帳以維持系統效能

### 注意事項

- 執行結帳前務必備份
- 確認結帳日期正確
- 確認是否需要保留舊資料
- 另存的舊帳本需妥善保管

---

## 4.4 搜尋與統計

### 科目統計

- 檢視特定科目的交易總額
- 顯示交易筆數
- 計算平均金額

### 時期統計

- 按月份統計收支
- 按年度統計收支
- 比較不同時期的財務狀況

### 明細統計

- 統計特定明細的支出
- 分析消費習慣
- 識別主要支出來源

---

## 報表最佳實踐

### 定期檢視

- 每月檢視損益表了解收支情況
- 每季檢視資產負債表了解財務狀況
- 年度檢視評估財務目標達成情況

### 資料匯出

- 定期匯出 CSV 檔案作為備份
- 使用 Excel 進行進階分析
- 保留年度財務報表作為記錄

### 結帳管理

- 接近 30,000 筆上限時執行結帳
- 年度更換時可考慮結帳
- 舊資料另存以保留歷史記錄

---

## 相關功能

- 科目設定請參閱 [基礎設定功能](./01-basic-setup.md)
- 交易記錄請參閱 [記帳功能](./02-transaction-management.md)
- 資料備份請參閱 [資料管理](./05-data-management.md)
