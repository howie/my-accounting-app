# 資料管理

## 5.1 備份資料

### 功能描述
手動或自動備份帳本資料，確保資料安全。

### 手動備份

#### 操作步驟
1. 進入帳本清單（點選圖示）
2. 選擇要備份的帳本
3. 按下備份按鈕
4. 選擇儲存位置
5. 檔名可自由變更
6. 儲存為 .mbu 檔案
7. 備份完成

#### 備份檔案
- **格式**：.mbu（MyAB Backup）
- **內容**：完整帳本資料，包括所有交易、科目設定、快速入帳、定期記錄等
- **命名**：可自訂檔名，建議包含日期（如 2024-12-31.mbu）

### 還原備份

#### 操作步驟
1. 按下還原按鈕
2. 選擇備份檔案（.mbu）並開啟
3. 輸入還原後的帳本名稱（或使用原名稱）
4. 確認後開始還原
5. 還原成功後可開啟帳本

#### 注意事項
- 還原會創建新帳本，不會覆蓋現有帳本
- 如需覆蓋，需先刪除舊帳本再還原

### 自動備份

#### 功能說明
- 軟體於**關閉時自動備份**
- 每天僅保留一份最新檔案
- 檔案名稱標註備份日期
- 系統自動保留最近 **10 個備份檔案**

#### 預設儲存路徑
```
C:\Program files\MyAB\Backup\
```

#### 自訂備份路徑
1. 進入「一般設定」
2. 選擇「儲存」選項頁
3. 自訂自動備份路徑
4. 確認儲存

### 還原系統備份

#### 操作步驟
1. 在帳本選單或登入畫面
2. 點選「還原系統備份」按鈕
3. 系統顯示最近 10 個自動備份
4. 選擇要還原的備份日期
5. 確認還原

#### 使用場景
- 資料異常需要還原到前幾天
- 誤刪資料需要復原
- 測試功能後需要還原

### 重灌電腦後的還原

#### 操作步驟
1. 重新安裝 MyAB 軟體
2. 在登入畫面點選「還原備份」按鈕
3. 選擇之前保存的備份檔案
4. 軟體會**自動重建用戶帳號**
5. 還原完成後即可使用

#### 重要提示
- 重灌前務必備份資料並保存好備份檔
- 系統會自動重建帳號，無需手動設定

### 備份策略建議

#### 定期手動備份
- 每週/每月手動備份一次
- 保存到外部儲存裝置（隨身碟、外接硬碟）
- 重要資料變更後立即備份

#### 利用自動備份
- 確保自動備份功能啟用
- 定期檢查自動備份是否正常
- 重要操作前確認已有最新備份

#### 多地備份
- 本機備份
- 雲端備份（透過雲端硬碟同步）
- 外部儲存裝置備份

---

## 5.2 匯出或列印資料

### 功能描述
將資料匯出為不同格式，以便列印、分析或分享。

### 匯出方式

#### 1. 單一科目匯出
**用途**：針對特定科目的資料進行匯出操作

**操作步驟**：
1. 選擇要匯出的科目
2. 設定日期範圍
3. 選擇匯出格式（HTML 或 CSV）
4. 指定儲存位置和檔名
5. 執行匯出

**適用場景**：
- 匯出特定支出科目分析
- 檢視某資產科目的交易歷史
- 產生單一科目報表

#### 2. 跨科目時期匯出
**用途**：不分科目匯出某一段時期的資料

**操作步驟**：
1. 選擇跨科目匯出功能
2. 設定日期範圍
3. 選擇匯出格式
4. 執行匯出

**特點**：
- 產生的 CSV 檔案為**完整格式**
- 可供軟體後續匯入使用
- 包含所有科目的交易

### 匯出格式

#### HTML 網頁檔

**特性**：
- 格式化顯示，易於閱讀
- 可用瀏覽器開啟
- 支援直接列印
- **無法用於匯入**

**適用場景**：
- 列印交易清單
- 分享給不使用軟體的人員
- 歸檔保存（PDF 轉換）

**檔案範例**：
```html
<table>
  <tr>
    <th>日期</th>
    <th>科目</th>
    <th>金額</th>
    <th>明細</th>
  </tr>
  <tr>
    <td>2024/01/01</td>
    <td>E-餐飲費</td>
    <td>50</td>
    <td>午餐</td>
  </tr>
</table>
```

#### CSV 檔

**特性**：
- 完整資料格式
- 可用 Excel 開啟和編輯
- **支援匯入軟體**
- 便於資料處理和分析

**適用場景**：
- 資料備份
- 使用 Excel 進階分析
- 轉移資料到其他帳本
- 資料交換

**檔案格式**：
```csv
日期,交易類型,支出科目,收入科目,從科目,到科目,金額,明細,發票號碼
2024/01/01,支出,E-餐飲費,,A-現金,,50,午餐,
2024/01/05,收入,,I-薪資,,A-銀行帳戶,30000,月薪,
```

### 列印功能

#### 實現方式
軟體本身不直接支援列印功能，需透過匯出功能間接實現：

**方法一：匯出為 HTML 後列印**
1. 匯出為 HTML 檔案
2. 用瀏覽器開啟
3. 使用瀏覽器的列印功能

**方法二：匯出為 CSV 後用 Excel 列印**
1. 匯出為 CSV 檔案
2. 用 Excel 開啟
3. 格式化排版
4. 使用 Excel 列印功能

### 業務規則
- HTML 格式僅供檢視和列印，無法匯入
- CSV 格式可匯入，但需是完整格式
- 單一科目匯出的 CSV 可能不含完整欄位
- 跨科目時期匯出的 CSV 為完整格式

---

## 5.3 匯入資料

### 功能描述
從 CSV 檔案匯入交易記錄到帳本中。

### 操作步驟
1. 點擊圖示進入「下載記帳資料」功能
   - 注意：匯入與網路資料下載在同一位置
2. 點選「匯入檔案」選項
3. 選擇要匯入的 CSV 檔案
4. 系統會把資料列出在畫面上供預覽
5. 檢查資料正確性
6. 點擊「加入帳本」按鈕完成匯入

### 支援的檔案格式

#### CSV 檔案要求
- **格式**：必須是從 MyAB 記錄總覽功能匯出的 CSV 檔
- **編碼**：建議使用 UTF-8 編碼
- **欄位**：需包含所有必要欄位

#### 可匯入的 CSV 來源
- 從 MyAB 匯出的 CSV 檔案
- 從其他帳本匯出的資料
- 從 MacMoney 轉換的資料（需特殊處理）

### CSV 檔案格式要求

**必要欄位**：
```
日期,交易類型,支出科目,收入科目,從科目,到科目,金額,明細,發票號碼
```

**範例**：
```csv
2024/01/01,支出,E-餐飲費,,A-現金,,50,午餐,
2024/01/05,收入,,I-薪資,,A-銀行帳戶,30000,月薪,
2024/01/10,轉帳,,,A-現金,A-銀行存款,10000,存錢,
```

### 匯入規則

#### 科目匹配
- 匯入時會檢查科目是否存在
- 如科目不存在，可能需要先建立科目
- 建議先匯入到測試帳本確認

#### 資料驗證
- 系統會檢查日期格式
- 驗證金額是否為數字
- 檢查必要欄位是否完整

#### 重複處理
- 系統不會自動檢查重複記錄
- 可能產生重複交易
- 建議匯入前先確認資料

### 使用場景

#### 場景一：合併多個帳本資料
1. 從帳本 A 匯出 CSV
2. 從帳本 B 匯出 CSV
3. 將兩個 CSV 合併
4. 匯入到新帳本

#### 場景二：從網路記帳下載資料
1. 在網路記帳網站記錄交易
2. 匯出為 CSV 檔案
3. 匯入到桌面版軟體

#### 場景三：資料轉移
1. 從舊帳本匯出特定時期資料
2. 匯入到新帳本
3. 整合歷史資料

### 注意事項
- 匯入前建議先備份現有資料
- 大量資料匯入前先測試小批次
- 匯入後檢查資產負債餘額是否正確
- 確認所有科目都已正確匯入

---

## 5.4 雲端同步

### 功能描述
透過雲端硬碟同步帳本資料，實現多裝置存取和自動備份。

### 支援的雲端服務
- **Dropbox**
- **Google Drive**
- **OneDrive**
- **其他可以同步電腦內檔案的雲端空間**

### 設定方式

#### 基本原理
- 將 MyAB 資料儲存路徑指向雲端硬碟資料夾
- 雲端服務自動同步檔案
- 不同裝置存取相同雲端資料夾即可同步

#### 設定步驟

**步驟一：備份現有資料**
1. 執行備份功能
2. 保存備份檔案

**步驟二：安裝雲端硬碟軟體**
1. 安裝 Dropbox/Google Drive/OneDrive
2. 登入帳號
3. 確認同步資料夾位置

**步驟三：設定 MyAB 資料路徑**
1. 在雲端同步資料夾內建立 MyAB 資料夾
   - 範例：`C:\Users\Username\Dropbox\MyAB\`
2. 開啟 MyAB 軟體
3. 進入「一般設定」→「儲存」選項
4. 指定資料路徑至雲端資料夾
5. 確認儲存

**步驟四：還原資料**
1. 點選還原備份
2. 選擇步驟一的備份檔案
3. 還原到新路徑

### 設定範例

#### Dropbox 設定
```
雲端資料夾：C:\Users\Username\Dropbox\
建立資料夾：C:\Users\Username\Dropbox\MyAB\
MyAB 設定路徑：C:\Users\Username\Dropbox\MyAB\
```

#### Google Drive 設定
```
雲端資料夾：C:\Users\Username\Google Drive\
建立資料夾：C:\Users\Username\Google Drive\MyAB\
MyAB 設定路徑：C:\Users\Username\Google Drive\MyAB\
```

### 多裝置同步

#### 在第二台電腦設定

**步驟一：安裝雲端硬碟軟體**
- 使用相同帳號登入
- 確認檔案已同步下載

**步驟二：安裝 MyAB 軟體**
- 下載並安裝 MyAB
- 輸入註冊碼

**步驟三：指定資料路徑**
- 進入「一般設定」→「儲存」
- 指定路徑至雲端資料夾
- 範例：`C:\Users\Username\Dropbox\MyAB\`

**步驟四：開始使用**
- 無需還原備份
- 直接登入帳號即可使用

### 使用注意事項

#### 同步時機
- 確保雲端軟體在背景執行
- 修改資料後等待同步完成再關閉電腦
- 避免同時在多台電腦修改資料

#### 衝突處理
- 如同時在兩台電腦修改，可能產生衝突檔案
- 雲端服務會保留兩個版本
- 需手動選擇正確版本

#### 網路需求
- 需要網路連線才能同步
- 離線時可繼續使用，待上線後同步

### 版本需求
- MyAB v3.1.3 版或更高版本

---

## 5.5 帳本合併

### 功能描述
將多個帳本合併為一個，整合分散的記帳資料。

### 使用場景
- 將多個短期帳本（如月度帳本）合併成年度帳本
- 合併不同用途的帳本
- 整合歷史資料

### 完整操作步驟

#### 準備階段

**步驟一：備份資料**
1. 使用複製功能先備份所有要合併的帳本
2. 避免合併失敗導致資料損壞
3. 確認備份成功

#### 合併流程

**步驟二：開啟主帳本**
1. 開啟較早期的帳本（如 1 月份資料）
2. 這將成為合併後的主帳本

**步驟三：執行合併**
1. 選擇「合併帳本」選項
2. 指定要合併的目標帳本（如 2 月份資料）
3. 確認合併

**步驟四：重新開啟**
1. 關閉帳本
2. 重新開啟合併後的帳本
3. 系統會整合所有資料

**步驟五：重複合併**
- 如有多個帳本需合併
- 重複步驟三至四
- 依序合併其他帳本（3月、4月...）

#### 清理與驗證

**步驟六：檢查 Equity 帳戶**
1. 搜尋 Equity 科目的所有記錄
2. 系統會保留每個帳本的期初 Equity
3. 應以最早月份的 Equity 為主
4. 刪除其他重複的 Equity 記錄

**步驟七：資料驗證**
1. 檢查資產負債表是否正確
2. 確認所有月份的資料都已包含
3. 驗證科目餘額是否正確
4. 若有誤可復原備份重做

**步驟八：更新名稱**
1. 將帳本名稱改為年度標識
2. 範例：「2024年」或「2024年度帳本」

### 合併範例

#### 範例：合併月度帳本為年度帳本

**初始狀態**：
- 帳本：2024年1月
- 帳本：2024年2月
- 帳本：2024年3月
- ...
- 帳本：2024年12月

**操作流程**：
1. 備份所有 12 個月帳本
2. 開啟「2024年1月」
3. 合併「2024年2月」→ 關閉並重新開啟
4. 合併「2024年3月」→ 關閉並重新開啟
5. 依此類推合併到 12 月
6. 刪除重複的 Equity 記錄（保留1月的）
7. 驗證資料正確性
8. 更名為「2024年度」

**最終結果**：
- 帳本：2024年度（包含全年資料）
- 備份：12 個月度帳本備份

### 業務規則
- 必須先進行備份
- Equity 帳戶需手動清理重複項目
- 建議從最早月份開始合併
- 完成前應充分驗證所有數據
- 合併是單向操作，無法拆分

### 關鍵注意事項
- **務必備份**：合併前一定要備份
- **Equity 清理**：合併後檢查並清理 Equity
- **逐步合併**：一次合併一個帳本，不要跳過
- **驗證資料**：每次合併後驗證資料正確性

---

## 5.6 延續舊帳本記錄

### 功能描述
開設新帳本，同時保留舊帳本的資產負債餘額，實現帳本的延續性。

### 方式一（推薦）：使用複製與結帳

#### 操作步驟

**步驟一：複製舊帳本**
1. 在帳本清單中選擇現有帳本
2. 使用複製功能建立副本
3. 副本包含所有資料

**步驟二：更名**
1. 將複製的帳本重新命名
2. 使用新帳本名稱（如「2025年」）

**步驟三：結帳處理**
1. 開啟新命名的帳本
2. 使用結帳功能
3. 設定結帳日期（如 2024/12/31）
4. **不要勾選**「結帳後另存新帳本」
5. 確認執行

**步驟四：確認完成**
1. 系統清除結帳日期前的所有交易記錄
2. 保留各科目在結帳日的餘額作為期初
3. 新帳本準備就緒

#### 優點
- 操作簡單快速
- 自動計算期初餘額
- 確保資料連續性
- 保留科目設定

### 方式二：手動建立新帳本

#### 操作步驟

**步驟一：建立新帳本**
1. 點選建立新帳本
2. 輸入帳本名稱
3. 設定初始現金為 0（稍後調整）

**步驟二：套用舊帳本資料**
1. 參考舊帳本的資產負債表
2. 記錄各科目的期末餘額

**步驟三：建立科目**
1. 在新帳本中建立所需科目
2. 確保科目與舊帳本一致

**步驟四：輸入期初餘額**
1. 為每個資產科目輸入轉帳記錄
   - 從 Equity 轉入資產科目
   - 金額為期末餘額
2. 為每個負債科目輸入轉帳記錄
   - 從負債科目轉出到 Equity
   - 金額為期末餘額

**步驟五：確認完成**
1. 檢查資產負債表
2. 確認與舊帳本期末一致

#### 範例：手動輸入期初
```
舊帳本期末（2024/12/31）：
A-現金：10,000
A-銀行存款：50,000
L-信用卡：5,000

新帳本期初（2025/01/01）記錄：
1. Equity → A-現金：10,000
2. Equity → A-銀行存款：50,000
3. L-信用卡 → Equity：5,000
```

### 官方建議
**建議使用第一種方法（複製與結帳）比較方便**

### 使用場景
- 年度換帳
- 開始新的記帳週期
- 清理舊資料但保留餘額

### 比較

| 項目 | 方式一（複製+結帳） | 方式二（手動建立） |
|------|-------------------|------------------|
| 操作難度 | 簡單 | 較複雜 |
| 時間成本 | 快速 | 較慢 |
| 錯誤風險 | 低 | 較高 |
| 科目保留 | 自動 | 需手動建立 |
| 推薦度 | ★★★★★ | ★★ |

---

## 5.7 兩地使用設定

### 功能描述
在不同地點（如公司和家中）使用軟體，保持資料同步。

### 方案 A：雲端硬碟同步（推薦）

#### 家中電腦設定步驟

**步驟一：建立雲端資料夾**
1. 在 Dropbox/Google Drive/OneDrive 建立 MyAB 資料夾

**步驟二：備份資料**
1. 執行備份功能
2. 保存備份檔案

**步驟三：指定資料路徑**
1. 進入一般設定→儲存分頁
2. 指定資料路徑至雲端硬碟
   - 範例：`C:\Users\Username\Dropbox\MyAB\`
3. 確認儲存

**步驟四：還原資料**
1. 還原備份檔案到新路徑
2. 確認資料正常

#### 公司電腦設定

**步驟一：安裝雲端軟體**
1. 安裝 Dropbox/Google Drive/OneDrive
2. 使用相同帳號登入
3. 確認檔案已同步

**步驟二：安裝 MyAB**
1. 下載並安裝 MyAB
2. 輸入註冊碼

**步驟三：指定路徑**
1. 進入一般設定→儲存
2. 指定相同的雲端資料夾路徑
3. 無需還原，直接使用

#### 優點
- 自動同步，無需手動操作
- 即時更新，兩地資料一致
- 同時具備雲端備份功能

#### 適用雲端服務
- Dropbox
- Google Drive
- OneDrive

### 方案 B：手動備份與還原

#### 操作流程

**在家中電腦**：
1. 記帳後執行備份
2. 將備份檔複製至隨身碟

**在公司電腦**：
1. 從隨身碟複製備份檔
2. 執行還原功能
3. 開始記帳

**回到家中電腦**：
1. 從隨身碟複製最新備份
2. 執行還原
3. 繼續記帳

#### 優點
- 不需要網路
- 完全離線作業
- 資料安全性高

#### 缺點
- 需要手動操作
- 容易忘記備份
- 可能產生資料版本混亂

### 方案 C：網路記帳功能

#### 功能說明
- 不是同步資料，而是暫時線上記錄
- 在公司透過瀏覽器記帳
- 回家後下載到 MyAB 軟體

#### 操作流程

**在公司**：
1. 開啟瀏覽器
2. 登入網路記帳網站
3. 進行記帳

**回家後**：
1. 開啟 MyAB 軟體
2. 使用「下載記帳資料」功能
3. 將網路資料下載到帳本

#### 優點
- 不需要安裝軟體
- 任何電腦都可使用
- 手機也可以記帳

#### 缺點
- 需要網路連線
- 功能較桌面版簡化
- 需要額外的下載步驟

### 方案比較

| 方案 | 便利性 | 自動化 | 網路需求 | 推薦度 |
|-----|--------|--------|---------|--------|
| 雲端同步 | ★★★★★ | ★★★★★ | 需要 | ★★★★★ |
| 手動備份 | ★★ | ★ | 不需要 | ★★ |
| 網路記帳 | ★★★ | ★★★ | 需要 | ★★★ |

---

## 5.8 換新電腦保存資料

### 功能描述
重灌電腦或換新電腦時保存和轉移資料。

### 重灌電腦的步驟

#### 重灌前準備

**步驟一：備份資料**
1. 開啟 MyAB 軟體
2. 執行備份功能
3. 將備份檔保存到：
   - 隨身碟
   - 外接硬碟
   - 雲端硬碟
4. 確認備份檔案可正常開啟

**步驟二：記錄註冊碼**
- 記下註冊 Email 和註冊碼
- 重灌後需要重新輸入

#### 重灌後恢復

**步驟一：重新安裝**
1. 下載 MyAB 軟體
2. 安裝到電腦
3. 輸入註冊碼啟用

**步驟二：還原資料**
1. 執行程式進入登入畫面
2. 點選「還原備份」按鈕
3. 選擇之前保存的備份檔
4. 系統會**自動重建帳號**
5. 還原完成

**步驟三：確認資料**
1. 登入帳號
2. 檢查帳本資料
3. 確認一切正常

### 換新電腦的步驟

#### 在舊電腦

**步驟一：產生備份檔**
1. 開啟 MyAB
2. 執行備份功能
3. 保存備份檔

**步驟二：轉移檔案**
1. 將備份檔複製到：
   - 隨身碟
   - 網路硬碟
   - 雲端硬碟
   - Email 給自己

#### 在新電腦

**步驟一：安裝軟體**
1. 下載 MyAB 軟體
2. 安裝到新電腦
3. 輸入註冊碼

**步驟二：轉移備份檔**
1. 將備份檔複製到新電腦

**步驟三：還原資料**
1. 執行 MyAB 到登入畫面
2. 點選「還原備份」按鈕
3. 選擇複製的備份檔
4. 系統自動重建帳號和資料

**步驟四：開始使用**
1. 登入帳號
2. 檢查資料完整性
3. 開始正常使用

### 重要提示

#### 自動重建帳號
- 系統會自動重建用戶帳號
- 無需手動建立帳號
- 帳號名稱和密碼與原本相同

#### 注意事項
- 務必在重灌前備份
- 確認備份檔可正常開啟
- 記錄註冊碼資訊
- 建議多地備份（隨身碟+雲端）

---

## 5.9 MacMoney 資料轉換至 MyAB

### 功能描述
將 MacMoney（macOS 版記帳軟體）的資料轉換到 MyAB（Windows 版）。

### 系統要求
- MyAB 版本 **3.5.6 或更高版本**

### 操作步驟

#### 步驟 1：在 MacMoney 匯出資料

1. 開啟 MacMoney 應用程式
2. 設定所需的日期範圍
3. 點選「帳本」選單
4. 選擇「匯出」功能
5. 選取「所有科目（可匯入）」選項
6. 將資料另存為 CSV 檔案格式
7. 記住檔案儲存位置

#### 步驟 2：轉移檔案

1. 將 CSV 檔案複製到 Windows 電腦
2. 可使用：
   - 隨身碟
   - 網路共享
   - 雲端硬碟
   - Email 傳送

#### 步驟 3：在 MyAB 匯入資料

1. 開啟 MyAB 軟體
2. 開啟要匯入資料的帳本
3. 在工具列找到「其他(M)」選單
4. 點選「匯入 MacMoney 的 CSV 檔」
5. 選擇從 Mac 複製的 CSV 檔案
6. 系統開始匯入資料
7. 匯入完成後檢查資料

### 注意事項

#### 科目對應
- 系統會自動對應科目
- 如有科目不存在，可能需要手動建立
- 建議先檢查科目設定

#### 資料驗證
- 匯入後檢查資產負債表
- 確認金額是否正確
- 檢查交易記錄完整性

#### 建議流程
1. 先在測試帳本匯入
2. 確認資料正確後再匯入正式帳本
3. 匯入前備份現有資料

### 使用場景
- 從 Mac 轉換到 Windows
- 同時使用兩個平台
- 資料整合需求

---

## 相關功能

- 基礎設定請參閱 [基礎設定功能](./01-basic-setup.md)
- 帳本合併範例請參閱 [報表與分析](./04-reports-analysis.md)
- 故障排除請參閱 [問題排除](./08-troubleshooting.md)
