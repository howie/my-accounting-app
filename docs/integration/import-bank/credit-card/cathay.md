# 國泰世華信用卡 CSV 格式

## 狀態

✅ 有實際 CSV 樣本，已實作

## CSV 樣本

```csv
2026/02信用卡對帳單
帳單資訊,,,

帳單明細
新臺幣
"消費日","交易說明","新臺幣金額","卡號/行動末四碼","消費國家/幣別","消費金額","入帳起息日","折算日"
"−","上期帳單總額","112,297","−","−","−","−","−"
"02/03","ＣＵＢＥＡｐｐ轉帳繳款","-112,297","9341","−","−","02/03","−"
"01/15","星巴克信義店","150","9341","TW / TWD","−","01/21","−"
"01/16","全聯福利中心","520","9341","TW / TWD","−","01/22","−"
```

## 欄位說明

| index | 欄位名稱        | 格式         | 說明                                        |
| ----- | --------------- | ------------ | ------------------------------------------- |
| 0     | 消費日          | MM/DD        | 無年份，從第一行 `YYYY/MM信用卡對帳單` 推算 |
| 1     | 交易說明        | string       | 商店/交易名稱                               |
| 2     | 新臺幣金額      | 數字，有逗號 | 正數=消費，負數=繳款（skip）                |
| 3     | 卡號/行動末四碼 | string       | 不使用                                      |
| 4     | 消費國家/幣別   | string       | 不使用                                      |
| 5     | 消費金額        | string       | 外幣金額，不使用                            |
| 6     | 入帳起息日      | MM/DD        | 不使用                                      |
| 7     | 折算日          | string       | 不使用                                      |

## 特殊處理

- **BOM**：有時有 UTF-8 BOM，需移除
- **動態標題**：第一行為 `YYYY/MM信用卡對帳單`，用 regex `(\d{4})/(\d{2})信用卡對帳單` 抓年月
- **header_marker**：`消費日`，動態定位資料起始行
- **跨年**：消費月 > 帳單月 → 年份 = 帳單年 - 1
- **skip_negative_amounts**：True（跳過繳款記錄）

## BankCsvConfig

```python
BankCsvConfig(
    code="CATHAY",
    name="國泰世華",
    date_column=0,
    date_format="%m/%d",
    description_column=1,
    amount_column=2,
    skip_rows=1,
    encoding="utf-8",
    header_marker="消費日",
    skip_negative_amounts=True,
    date_year_pattern=r"(\d{4})/(\d{2})信用卡對帳單",
)
```
